import { i as i$1, r as r$1, t } from './transframe-provider-e657167f.js';
import { r as r$2 } from './browser-polyfill-f636ce7e.js';

var i=class{constructor(s){t(this,"_isConnected",!1),t(this,"_messageHandler",(()=>{})),t(this,"_port"),t(this,"_options"),t(this,"_messageHandlerWrapper",(e=>{this._messageHandler(e);})),this._options=s;}get isConnected(){return this._isConnected}connect(){const e=()=>{this._port=r$2.runtime.connect({name:this._options?.channelName??"transframe"}),this._port.onMessage.addListener(this._messageHandlerWrapper),this._isConnected=!0,this._port.onDisconnect.addListener((()=>{this._isConnected&&(this._isConnected=!1,this.connect());}));},s=window.document;s.prerendering?s.addEventListener("prerenderingchange",(()=>{s.prerendering||e();})):e();}disconnect(){this._port?.onMessage.removeListener(this._messageHandlerWrapper),this._port?.disconnect(),this._isConnected=!1;}sendMessage(e){this._port?.postMessage(e);}onMessage(e){this._messageHandler=e;}},r=class{constructor(){t(this,"_isListening",!1),t(this,"_messageHandler",(()=>{})),t(this,"_messageHandlerWrapper",((e,s)=>{const n={fromId:void 0,port:e};this._messageHandler(s,(s=>{e.sender&&e.postMessage(s);}),n);})),t(this,"_deleteTimer",(e=>{clearTimeout(e._timer),delete e._timer;})),t(this,"_forceReconnect",(e=>{this._deleteTimer(e),e.disconnect();})),t(this,"_connectionListener",(e=>{e.onMessage.addListener((s=>{this._messageHandlerWrapper(e,s);})),e._timer=setTimeout(this._forceReconnect,25e4,e),e.onDisconnect.addListener(this._deleteTimer);}));}get isListening(){return this._isListening}listen(){r$2.runtime.onConnect.addListener(this._connectionListener),this._isListening=!0;}close(){r$2.runtime.onConnect.removeListener(this._connectionListener),this._isListening=!1;}onMessage(e){this._messageHandler=e;}registerFrame(e,s){throw new Error("Method not implemented.")}};function o(e){return new i$1(new i(e),e)}function a(e){return new r$1(new r,e)}

export { a, o };

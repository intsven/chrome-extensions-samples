import { r } from './browser-polyfill-f636ce7e.js';

const t={auth:{token:void 0,accessToken:void 0,savedAnonAccessToken:void 0,packageInstallAccessTokens:{}},twitch:{headers:{}},newTab:{pinnedChannelsExperimental:[],topSites:[],hideTopSitesRequest:!1,lateOptOutState:!1},settings:{theaterMode:!0,chatBatching:!0,chatStyles:!0,experimental:!1,experimentalSidebar:!1,newTabExperimental:!1,newTabOnboarded:!1,twitchFollowing:!0,hideEmojiFountain:!1},cache:{},packageInstallStorage:{},embed:{devEmbeds:{}},sidebar:{hasViewedSidebarLocationTooltip:!1,config:{}}},n=r.storage.local,a=Object.fromEntries(Object.keys(t).map((e=>[e,new Set])));r.storage.onChanged.addListener(((e,t)=>{if("local"!==t)return;const n={};for(const t in e){const[a,s]=t.split(".");n[a]||(n[a]={}),n[a][s]=e[t].newValue;}for(const e in a)if(n[e])for(const t of a[e].values())t.callback(n[e]);}));const s=e=>({get:async function(a){const s=e+"."+a,o=await n.get(s).then((e=>e[s]));return void 0===o?t[e][a]:o},set:async function(t,a){const s=e+"."+t;await n.set({[s]:a});},remove:async function(t){const a=e+"."+t;await n.remove(a);},subscribe:function(t){var s;const o={callback:t,unsubscribe:()=>{var t;null===(t=a[e])||void 0===t||t.delete(o);}};return null===(s=a[e])||void 0===s||s.add(o),n.get().then((t=>{o.callback(Object.fromEntries(Object.keys(t).filter((t=>t.startsWith(e+"."))).map((e=>[e.split(".")[1],t[e]]))));})),o}}),o=Object.fromEntries(Object.keys(t).map((e=>[e,s(e)])));

export { o, t };
